<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Detector Facial Híbrido (MediaPipe + OpenCV)</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --glow-cyan: #00ffff;
      --glow-pink: #ff00ff;
      --dark-blue: #0d0221;
    }

    body {
      background: radial-gradient(ellipse at bottom, var(--dark-blue) 0%, #000000 100%);
      font-family: 'Orbitron', sans-serif;
      color: var(--glow-cyan);
    }

    h1 {
      font-weight: 700;
      text-shadow: 0 0 5px var(--glow-cyan), 0 0 10px var(--glow-cyan), 0 0 20px var(--glow-pink), 0 0 30px var(--glow-pink);
    }

    .hud-display {
      border: 2px solid var(--glow-cyan);
      box-shadow: 0 0 15px var(--glow-cyan), inset 0 0 15px var(--glow-cyan);
      background-color: rgba(0, 255, 255, 0.05);
      padding: 5px;
      border-radius: 10px;
    }

    #status {
      background-color: rgba(0,0,0,0.5);
      color: var(--glow-pink);
      font-weight: 700;
      border-bottom-left-radius: 8px;
      border-bottom-right-radius: 8px;
    }

    .counter-card-futuristic {
      background: rgba(13, 2, 33, 0.5);
      border: 1px solid var(--glow-pink);
      box-shadow: 0 0 10px var(--glow-pink);
      border-radius: 8px;
      backdrop-filter: blur(5px);
      color: white;
      height: 100%;
    }

    .counter-card-futuristic .card-title {
      color: var(--glow-pink);
      font-weight: 700;
    }

    .counter-card-futuristic .counter-text {
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--glow-cyan);
      text-shadow: 0 0 5px var(--glow-cyan), 0 0 10px var(--glow-cyan);
    }
  </style>
</head>
<body>
  <div class="container mt-5">
    <div class="row justify-content-center">
      <div class="col-lg-9 col-md-12 text-center">
        <h1 class="mb-3">Detector de cara con open cv</h1>

        <div class="hud-display position-relative mx-auto" style="max-width: 650px;">
          <video id="video" class="d-none" width="640" height="480" autoplay playsinline muted></video>
          <canvas id="canvasOutput" class="rounded" width="640" height="480"></canvas>
          <div id="status" class="card-footer text-center">Cargando librerías...</div>
        </div>

        <div class="row mt-5">
          <div class="col-md-4 mb-3">
            <div class="card counter-card-futuristic">
              <div class="card-body">
                <h5 class="card-title">Cejas Arqueadas</h5>
                <p id="ceja-counter" class="card-text counter-text">0</p>
              </div>
            </div>
          </div>
          <div class="col-md-4 mb-3">
            <div class="card counter-card-futuristic">
              <div class="card-body">
                <h5 class="card-title">Boca Abierta</h5>
                <p id="boca-counter" class="card-text counter-text">0</p>
              </div>
            </div>
          </div>
          <div class="col-md-4 mb-3">
            <div class="card counter-card-futuristic">
              <div class="card-body">
                <h5 class="card-title">Parpadeos</h5>
                <p id="parpadeo-counter" class="card-text counter-text">0</p>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- MediaPipe -->
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/face_mesh.js" crossorigin="anonymous"></script>

  <!-- OpenCV -->
  <script>
    // Estado global de OpenCV
    let cvReady = false;
    window.onOpenCvReady = () => {
      cvReady = true;
      const st = document.getElementById('status');
      if (st) st.textContent = 'OpenCV listo. Cargando MediaPipe...';
    };
  </script>
  <script src="js/opencv.js" async onload="onOpenCvReady();"></script>

  <!-- App -->
  <script src="js/app.js"></script>
</body>
</html>
